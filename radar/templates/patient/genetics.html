{% extends 'patient/base.html' %}

{% set current_patient_page = 'genetics' %}
{% set current_patient_disease_group = disease_group %}

{% from 'macros/forms.html' import render_field_group, render_field_errors %}
{% from 'macros/forms.html' import render_horizontal_button as render_button %}

{% if read_only %}
    {% from 'macros/forms.html' import render_horizontal_field_read_only as render_field %}
{% else %}
    {% from 'macros/forms.html' import render_horizontal_field as render_field %}
{% endif %}

{% from 'macros/forms.html' import render_form_errors %}

{% block content %}
    <h1 class="page-header">Genetics</h1>

    {{ render_form_errors(form) }}

    <form method="POST" class="form-horizontal">
        {{ form.hidden_tag() }}

        {{ render_field(form.sample_sent) }}

        <div id="sample_sent_extra">
            {{ render_field(form.sample_sent_date) }}
            {{ render_field(form.laboratory) }}
            {{ render_field(form.laboratory_reference_number) }}

            <!-- TODO -->
            {% call render_field_group(form.results) %}
                {{ form.results.label(class='col-sm-4 control-label') }}

                <div class="col-sm-8">
                    {{ form.results(class='form-control', rows=10, disabled=read_only) }}
                    {{ render_field_errors(form.results) }}
                </div>
            {% endcall %}
        </div>

        {% if not read_only %}
            {% call render_button() %}
                <button type="submit" class="btn btn-success">Save</button>
            {% endcall %}
        {% endif %}
    </form>
{% endblock %}

{% block body_js %}
    <script>
        toggle_extra_fields('sample_sent', '#sample_sent_extra', 'y');
    </script>
{% endblock %}
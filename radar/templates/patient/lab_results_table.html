{% extends 'patient/lab_results_base.html' %}

{% set current_lab_results_page = 'table' %}

{% from 'macros/ordering.html' import render_sortable_column %}

{% block content %}
    {{ super() }}

    <form class="form lab-result-table" method="GET">
        <p>
            {{ form.item(class='form-control') }}
        </p>

        <p>
            <button type="submit" class="btn btn-primary btn-xs">Update Columns</button>
        </p>
    </form>

    <table class="table-condensed table-striped table-bordered">
        <thead>
            <tr>
                <th>{{ render_sortable_column(ordering, 'date', 'Date') }}</th>

                {% for name, key in item_columns %}
                    <th>{{ render_sortable_column(ordering, key, name) }}</th>
                {% endfor %}

                <th>{{ render_sortable_column(ordering, 'source', 'Source') }}</th>
            </tr>
        </thead>

        <tbody>
            {% for result in results %}
                <tr>
                    <td>{{ result.date | datetime_format("%d/%m/%Y %H:%M") | missing }}</td>

                    {% for column in result.columns %}
                        <td>{{ column | missing }}</td>
                    {% endfor %}

                    <td>{{ result.source | missing }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}